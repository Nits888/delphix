# Extend jsonschema with custom hostname validator
def extended_validate(instance, schema):
    validate(instance=instance, schema=schema)
    if "allowed_ips" in instance:
        for ip_or_hostname in instance["allowed_ips"]:
            if ip_or_hostname == "ANY":
                continue
            if not (re.match(r"^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$", ip_or_hostname) or is_valid_hostname(ip_or_hostname)):
                raise exceptions.ValidationError(f"'{ip_or_hostname}' is not a valid IP, hostname, or the value 'ANY'")
